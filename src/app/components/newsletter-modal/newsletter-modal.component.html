<div class="modal-backdrop" *ngIf="modal.isOpen()" (click)="onBackdropClick($event)">
  <div
    class="modal-shell"
    role="dialog"
    aria-modal="true"
    aria-labelledby="newsletter-title"
    aria-describedby="newsletter-desc"
  >
    <div class="glow orb-one"></div>
    <div class="glow orb-two"></div>

    <button class="close" type="button" aria-label="Schließen" (click)="modal.close()">
      <span>&times;</span>
    </button>

    <div class="modal-grid">
      <div class="intro">
        <p class="eyebrow">Loop dich ein</p>
        <h3 id="newsletter-title">Festivalfunk &amp; Updates</h3>
        <p id="newsletter-desc">
          Kein Feed-Overload, sondern das Wesentliche: Wir schicken dir wichtige Infos rund ums
          Festival, damit du bestens vorbereitet bist. Zudem bekommst du nach dem Event exklusive
          Aftermovie-Links und einen Umfragebogen, um dein Feedback zu teilen, damit wir uns jedes
          Jahr weiter verbessern können.
        </p>

        <div class="perk-grid">
          <div class="perk">
            <span class="label">Reminders</span>
            <p>Für Anreise, Timetable und Camping.</p>
          </div>
          <div class="perk">
            <span class="label">Aftermovie</span>
            <p>Exklusive Aftermovie-Links.</p>
          </div>
          <div class="perk">
            <span class="label">Feedback</span>
            <p>Umfragebogen nach dem Festival.</p>
          </div>
          <div class="perk">
            <span class="label">Ticketsale</span>
            <p>Ticketverkaufs start für 2027.</p>
          </div>
        </div>
      </div>

      <form
        class="form"
        [formGroup]="form"
        (ngSubmit)="onSubmit()"
        novalidate
        [attr.action]="ckAction"
        method="post"
        [attr.data-sv-form]="ckFormId"
        [attr.data-uid]="ckUid"
        attr.data-format="inline"
        attr.data-version="5"
      >
        <label class="field">
          <span>Dein Name (optional)</span>
          <input type="text" formControlName="name" placeholder="z. B. Mira" />
        </label>

        <label class="field required">
          <span>E-Mail</span>
          <input type="email" formControlName="email" placeholder="du@beispiel.de" required />
          <small class="error" *ngIf="hasError('email')">Bitte gib eine gültige Adresse an.</small>
        </label>

        <label class="checkbox">
          <input type="checkbox" formControlName="consent" />
          <div>
            <span>Ich möchte Updates per Mail erhalten und habe die Datenschutzinfos gelesen.</span>
            <small class="error" *ngIf="hasError('consent')">
              Bitte stimme zu, damit wir dich anpingen können.
            </small>
            <small class="hint">Keine Werbung außerhalb von Bachblyten.</small>
          </div>
        </label>

        <div class="actions">
          <button class="cta" type="submit" [disabled]="isSubmitting">
            <span *ngIf="isSubmitting">Sende...</span>
            <span *ngIf="!isSubmitting && !submittedSuccess">Anmelden</span>
            <span *ngIf="!isSubmitting && submittedSuccess">Vorgemerkt</span>
          </button>
          <button class="ghost" type="button" (click)="modal.close()">Abbrechen</button>
        </div>

        <div class="status" *ngIf="submittedSuccess">
          <strong>Erfolg!</strong>
          <p>Check deine Inbox und bestätige die Anmeldung.</p>
        </div>
        <div class="status error" *ngIf="submitError">
          <strong>Hmm, das hat nicht geklappt.</strong>
          <p>{{ submitError }}</p>
        </div>

        <p class="fineprint">Max. 2–4 Mails pro Jahr. Austragen geht jederzeit mit einem Klick.</p>
      </form>
    </div>
  </div>
</div>
